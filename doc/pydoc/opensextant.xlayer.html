<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Python: module opensextant.xlayer</title>
</head><body>

<table class="heading">
<tr class="heading-text decor">
<td class="title">&nbsp;<br><strong class="title"><a href="opensextant.html" class="white">opensextant</a>.xlayer</strong></td>
<td class="extra"><a href=".">index</a><br><a href="file:./python/opensextant/xlayer.py">./python/opensextant/xlayer.py</a></td></tr></table>
    <p><span class="code">Created&nbsp;on&nbsp;Mar&nbsp;14,&nbsp;2016<br>
&nbsp;<br>
@author:&nbsp;ubaldino</span></p>
<p>
<table class="section">
<tr class="decor pkg-content-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Modules</strong></td></tr>
    
<tr><td class="decor pkg-content-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><table><tr><td class="multicolumn"><a href="json.html">json</a><br>
</td><td class="multicolumn"><a href="requests.html">requests</a><br>
</td><td class="multicolumn"><a href="sys.html">sys</a><br>
</td><td class="multicolumn"></td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor index-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Classes</strong></td></tr>
    
<tr><td class="decor index-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl>
<dt class="heading-text"><a href="builtins.html#object">builtins.object</a>
</dt><dd>
<dl>
<dt class="heading-text"><a href="opensextant.xlayer.html#Geotagger">Geotagger</a>
</dt><dt class="heading-text"><a href="opensextant.xlayer.html#XlayerClient">XlayerClient</a>
</dt></dl>
</dd>
</dl>
 <p>
<table class="section">
<tr class="decor title-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><a name="Geotagger">class <strong>Geotagger</strong></a>(<a href="builtins.html#object">builtins.object</a>)</td></tr>
    
<tr><td class="decor title-decor" rowspan=2><span class="code">&nbsp;&nbsp;&nbsp;</span></td>
<td class="decor title-decor" colspan=2><span class="code"><a href="#Geotagger">Geotagger</a>(cfg:&nbsp;dict,&nbsp;debug=False,&nbsp;features=['geo',&nbsp;'postal',&nbsp;'taxons'])<br>
&nbsp;<br>
GEOTAGGER&nbsp;REST&nbsp;client<br>&nbsp;</span></td></tr>
<tr><td>&nbsp;</td>
<td class="singlecolumn">Methods defined here:<br>
<dl><dt><a name="Geotagger-__init__"><strong>__init__</strong></a>(self, cfg: dict, debug=False, features=['geo', 'postal', 'taxons'])</dt><dd><span class="code">Initialize&nbsp;self.&nbsp;&nbsp;See&nbsp;help(type(self))&nbsp;for&nbsp;accurate&nbsp;signature.</span></dd></dl>

<dl><dt><a name="Geotagger-dbg"><strong>dbg</strong></a>(self, msg, *args, **kwargs)</dt></dl>

<dl><dt><a name="Geotagger-error"><strong>error</strong></a>(self, msg, *args, **kwargs)</dt></dl>

<dl><dt><a name="Geotagger-infer_locations"><strong>infer_locations</strong></a>(self, locs: list) -&gt; dict</dt><dd><span class="code">Choose&nbsp;the&nbsp;best&nbsp;location&nbsp;from&nbsp;the&nbsp;list&nbsp;--&nbsp;Most&nbsp;specific&nbsp;is&nbsp;preferred.<br>
:param&nbsp;locs:&nbsp;list&nbsp;of&nbsp;locations<br>
:return:</span></dd></dl>

<dl><dt><a name="Geotagger-info"><strong>info</strong></a>(self, msg, *args, **kwargs)</dt></dl>

<dl><dt><a name="Geotagger-populate_mentions"><strong>populate_mentions</strong></a>(self, spans: list) -&gt; dict</dt></dl>

<dl><dt><a name="Geotagger-summarize"><strong>summarize</strong></a>(self, doc_id, text, lang=None) -&gt; dict</dt><dd><span class="code">Call&nbsp;the&nbsp;<a href="#XlayerClient">XlayerClient</a>&nbsp;process()&nbsp;endpoint,<br>
distills&nbsp;output&nbsp;tags&nbsp;into&nbsp;`geoinferences`&nbsp;and&nbsp;`mentions`&nbsp;(all&nbsp;other&nbsp;non-geo&nbsp;tags).<br>
A&nbsp;valid&nbsp;2-char&nbsp;ISO&nbsp;639&nbsp;language&nbsp;code&nbsp;helps&nbsp;to&nbsp;tune<br>
&nbsp;<br>
:param&nbsp;doc_id:&nbsp;ID&nbsp;of&nbsp;text<br>
:param&nbsp;text:&nbsp;the&nbsp;text&nbsp;input<br>
:param&nbsp;lang:&nbsp;&nbsp;language&nbsp;of&nbsp;the&nbsp;text<br>
:return:&nbsp;A&nbsp;single&nbsp;geoinference</span></dd></dl>

<hr>
Data descriptors defined here:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><span class="code">dictionary&nbsp;for&nbsp;instance&nbsp;variables&nbsp;(if&nbsp;defined)</span></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><span class="code">list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object&nbsp;(if&nbsp;defined)</span></dd>
</dl>
<hr>
Data and other attributes defined here:<br>
<dl><dt><strong>ALLOWED_SLOTS</strong> = {'admin', 'city', 'country', 'postal', 'site'}</dl>

</td></tr></table> <p>
<table class="section">
<tr class="decor title-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><a name="XlayerClient">class <strong>XlayerClient</strong></a>(<a href="builtins.html#object">builtins.object</a>)</td></tr>
    
<tr><td class="decor title-decor" rowspan=2><span class="code">&nbsp;&nbsp;&nbsp;</span></td>
<td class="decor title-decor" colspan=2><span class="code"><a href="#XlayerClient">XlayerClient</a>(server,&nbsp;options='')<br>
&nbsp;<br>
<br>&nbsp;</span></td></tr>
<tr><td>&nbsp;</td>
<td class="singlecolumn">Methods defined here:<br>
<dl><dt><a name="XlayerClient-__init__"><strong>__init__</strong></a>(self, server, options='')</dt><dd><span class="code">@param&nbsp;server:&nbsp;URL&nbsp;for&nbsp;the&nbsp;service.&nbsp;&nbsp;&nbsp;E.g.,&nbsp;host:port&nbsp;or&nbsp;'<a href="http://SERVER/xlayer/rest/process">http://SERVER/xlayer/rest/process</a>'.<br>
@keyword&nbsp;&nbsp;options:&nbsp;&nbsp;STRING.&nbsp;a&nbsp;comma-separated&nbsp;list&nbsp;of&nbsp;options&nbsp;to&nbsp;send&nbsp;with&nbsp;each&nbsp;request.<br>
There&nbsp;are&nbsp;no&nbsp;default&nbsp;options&nbsp;supported.</span></dd></dl>

<dl><dt><a name="XlayerClient-ping"><strong>ping</strong></a>(self, timeout=30)</dt><dd><span class="code">Timeout&nbsp;of&nbsp;30&nbsp;seconds&nbsp;is&nbsp;used&nbsp;here&nbsp;so&nbsp;calls&nbsp;do&nbsp;not&nbsp;hang&nbsp;indefinitely.<br>
:return:&nbsp;True&nbsp;if&nbsp;successful.</span></dd></dl>

<dl><dt><a name="XlayerClient-process"><strong>process</strong></a>(self, docid, text, lang=None, features=['geo'], timeout=10, preferred_countries=None, preferred_locations=None)</dt><dd><span class="code">Process&nbsp;text,&nbsp;extracting&nbsp;some&nbsp;entities<br>
&nbsp;<br>
&nbsp;&nbsp;lang&nbsp;=&nbsp;"xx"&nbsp;or&nbsp;None,&nbsp;where&nbsp;"xx"&nbsp;is&nbsp;a&nbsp;ISO&nbsp;language&nbsp;2-char&nbsp;code.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;general&nbsp;Chinese/Japanese/Korean&nbsp;(CJK)&nbsp;support,&nbsp;use&nbsp;lang&nbsp;=&nbsp;'cjk'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Language&nbsp;IDs&nbsp;that&nbsp;have&nbsp;some&nbsp;additional&nbsp;tuning&nbsp;include:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ja",&nbsp;"th",&nbsp;"tr",&nbsp;"id",&nbsp;"ar",&nbsp;"fa",&nbsp;"ur",&nbsp;"ru",&nbsp;"it",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"pt",&nbsp;"de",&nbsp;"nl",&nbsp;"es",&nbsp;"en",&nbsp;"tl",&nbsp;"ko",&nbsp;"vi"<br>
&nbsp;&nbsp;Behavior:&nbsp;&nbsp;Arabic&nbsp;(ar)&nbsp;or&nbsp;CJK&nbsp;(cjk)&nbsp;lang&nbsp;ID&nbsp;directs&nbsp;tagger&nbsp;to&nbsp;use&nbsp;language-specific&nbsp;tokenizers<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Otherwise&nbsp;other&nbsp;lang&nbsp;ID&nbsp;provided&nbsp;just&nbsp;invokes&nbsp;language-specific&nbsp;stopword&nbsp;filters<br>
&nbsp;<br>
&nbsp;&nbsp;features&nbsp;are&nbsp;places,&nbsp;coordinates,&nbsp;countries,&nbsp;orgs,&nbsp;persons,&nbsp;patterns,&nbsp;postal.&nbsp;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;feature&nbsp;aliases&nbsp;"geo"&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;get&nbsp;All&nbsp;Geographic&nbsp;entities&nbsp;(places,coordinates,countries)<br>
&nbsp;&nbsp;feature&nbsp;"taxons"&nbsp;can&nbsp;get&nbsp;at&nbsp;any&nbsp;Taxon&nbsp;"taxons",&nbsp;"persons",&nbsp;"orgs".&nbsp;&nbsp;As&nbsp;of&nbsp;Xponents&nbsp;3.6&nbsp;this&nbsp;reports&nbsp;ALL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Other&nbsp;taxons&nbsp;available&nbsp;in&nbsp;TaxCat&nbsp;tagger.&nbsp;&nbsp;"all-taxons"&nbsp;is&nbsp;offered&nbsp;as&nbsp;a&nbsp;means&nbsp;to&nbsp;distinguish&nbsp;old&nbsp;and&nbsp;new&nbsp;behavior.<br>
&nbsp;&nbsp;feature&nbsp;"postal"&nbsp;will&nbsp;tag&nbsp;obvious,&nbsp;qualified&nbsp;postal&nbsp;codes&nbsp;that&nbsp;are&nbsp;paired&nbsp;with&nbsp;a&nbsp;CITY,&nbsp;PROVINCE,&nbsp;or&nbsp;COUNTRY&nbsp;tag.<br>
&nbsp;&nbsp;feature&nbsp;"patterns"&nbsp;is&nbsp;an&nbsp;alias&nbsp;for&nbsp;dates&nbsp;and&nbsp;any&nbsp;other&nbsp;pattern-based&nbsp;extractors.&nbsp;For&nbsp;now&nbsp;"dates"&nbsp;is&nbsp;only&nbsp;one<br>
&nbsp;&nbsp;feature&nbsp;"codes"&nbsp;will&nbsp;tag,&nbsp;use&nbsp;and&nbsp;report&nbsp;coded&nbsp;information&nbsp;for&nbsp;any&nbsp;place;&nbsp;primarily&nbsp;administrative&nbsp;boundaries<br>
&nbsp;<br>
&nbsp;&nbsp;options&nbsp;are&nbsp;not&nbsp;observed&nbsp;by&nbsp;Xlayer&nbsp;"Xgeo",&nbsp;but&nbsp;you&nbsp;can&nbsp;adapt&nbsp;your&nbsp;own&nbsp;service<br>
&nbsp;&nbsp;to&nbsp;accomodate&nbsp;such&nbsp;options.&nbsp;&nbsp;&nbsp;Possible&nbsp;options&nbsp;are&nbsp;clean_input,&nbsp;lowercase,&nbsp;for&nbsp;example:<br>
&nbsp;<br>
&nbsp;&nbsp;*&nbsp;clean_input&nbsp;scrubs&nbsp;the&nbsp;input&nbsp;text&nbsp;if&nbsp;it&nbsp;has&nbsp;HTML&nbsp;or&nbsp;other&nbsp;content&nbsp;in&nbsp;it.<br>
&nbsp;&nbsp;*&nbsp;lowercase&nbsp;allows&nbsp;the&nbsp;tagging&nbsp;to&nbsp;pass&nbsp;on&nbsp;through&nbsp;lower&nbsp;case&nbsp;matches.<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;but&nbsp;interpretation&nbsp;of&nbsp;"clean&nbsp;text"&nbsp;and&nbsp;"lower&nbsp;case"&nbsp;support&nbsp;is&nbsp;subjective.<br>
&nbsp;&nbsp;so&nbsp;they&nbsp;are&nbsp;not&nbsp;supported&nbsp;out&nbsp;of&nbsp;the&nbsp;box&nbsp;here.<br>
:param&nbsp;docid:&nbsp;identifier&nbsp;of&nbsp;transaction<br>
:param&nbsp;text:&nbsp;Unicode&nbsp;text&nbsp;to&nbsp;process<br>
:param&nbsp;lang:&nbsp;One&nbsp;of&nbsp;["ar",&nbsp;"cjk",&nbsp;....&nbsp;other&nbsp;ISO&nbsp;language&nbsp;IDs]<br>
:param&nbsp;features:&nbsp;list&nbsp;of&nbsp;geo&nbsp;OR&nbsp;[places,&nbsp;coordinates,&nbsp;countries],&nbsp;orgs,&nbsp;persons,&nbsp;patterns,&nbsp;taxons<br>
:param&nbsp;timeout:&nbsp;default&nbsp;to&nbsp;10&nbsp;seconds;&nbsp;If&nbsp;you&nbsp;think&nbsp;your&nbsp;processing&nbsp;takes&nbsp;longer,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adjust&nbsp;if&nbsp;you&nbsp;see&nbsp;exceptions.<br>
:param&nbsp;preferred_countries:&nbsp;Array&nbsp;of&nbsp;country&nbsp;codes&nbsp;representing&nbsp;those&nbsp;which&nbsp;are&nbsp;preferred&nbsp;fall&nbsp;backs&nbsp;when<br>
&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;are&nbsp;ambiguous&nbsp;location&nbsp;names.<br>
:param&nbsp;preferred_locations:&nbsp;&nbsp;Array&nbsp;of&nbsp;geohash&nbsp;representing&nbsp;general&nbsp;area&nbsp;of&nbsp;desired&nbsp;preferred&nbsp;matches<br>
:return:&nbsp;array&nbsp;of&nbsp;TextMatch&nbsp;objects&nbsp;or&nbsp;empty&nbsp;array.</span></dd></dl>

<dl><dt><a name="XlayerClient-stop"><strong>stop</strong></a>(self, timeout=30)</dt><dd><span class="code">Timeout&nbsp;of&nbsp;30&nbsp;seconds&nbsp;is&nbsp;used&nbsp;here&nbsp;so&nbsp;calls&nbsp;do&nbsp;not&nbsp;hang&nbsp;indefinitely.<br>
The&nbsp;service&nbsp;URL&nbsp;is&nbsp;inferred:&nbsp;&nbsp;/process&nbsp;and&nbsp;/control&nbsp;endpoints&nbsp;should&nbsp;be&nbsp;next&nbsp;to&nbsp;each&nbsp;other.<br>
:return:&nbsp;True&nbsp;if&nbsp;successful&nbsp;or&nbsp;if&nbsp;"Connection&nbsp;aborted"&nbsp;ConnectionError&nbsp;occurs</span></dd></dl>

<hr>
Data descriptors defined here:<br>
<dl><dt><strong>__dict__</strong></dt>
<dd><span class="code">dictionary&nbsp;for&nbsp;instance&nbsp;variables&nbsp;(if&nbsp;defined)</span></dd>
</dl>
<dl><dt><strong>__weakref__</strong></dt>
<dd><span class="code">list&nbsp;of&nbsp;weak&nbsp;references&nbsp;to&nbsp;the&nbsp;object&nbsp;(if&nbsp;defined)</span></dd>
</dl>
</td></tr></table></td></tr></table><p>
<table class="section">
<tr class="decor functions-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Functions</strong></td></tr>
    
<tr><td class="decor functions-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><dl><dt><a name="-main_demo"><strong>main_demo</strong></a>()</dt></dl>
 <dl><dt><a name="-print_match"><strong>print_match</strong></a>(match: opensextant.TextMatch)</dt><dd><span class="code">:param&nbsp;match:<br>
:return:</span></dd></dl>
 <dl><dt><a name="-print_results"><strong>print_results</strong></a>(arr)</dt><dd><span class="code">:param&nbsp;arr:&nbsp;array&nbsp;of&nbsp;Annotations&nbsp;or&nbsp;TextMatch<br>
:return:</span></dd></dl>
 <dl><dt><a name="-process_text"><strong>process_text</strong></a>(extractor, txt, docid='$DOC-ID$', features=[], preferred_countries=[], preferred_locations=[])</dt></dl>
 <dl><dt><a name="-score_inferences"><strong>score_inferences</strong></a>(inf, matches)</dt></dl>
</td></tr></table><p>
<table class="section">
<tr class="decor data-decor heading-text">
<td class="section-title" colspan=3>&nbsp;<br><strong class="bigsection">Data</strong></td></tr>
    
<tr><td class="decor data-decor"><span class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></td><td>&nbsp;</td>
<td class="singlecolumn"><strong>GEOCODINGS</strong> = {'coord', 'coordinate', 'country', 'geo', 'place', 'postal'}</td></tr></table>
</body></html>